


sudoers(4)                 FILE FORMATS                sudoers(4)


NNNNAAAAMMMMEEEE
       sudoers - list of which users may execute what

DDDDEEEESSSSCCCCRRRRIIIIPPPPTTTTIIIIOOOONNNN
       The _s_u_d_o_e_r_s file is composed two types of entries: aliases
       (basically variables) and user specifications (which
       specify who may run what).  The grammar of _s_u_d_o_e_r_s will be
       described below in Extended Backus-Naur Form (EBNF).
       Don't despair if you don't know what EBNF is, it is fairly
       simple and the definitions below are annotated.

       QQQQuuuuiiiicccckkkk gggguuuuiiiiddddeeee ttttoooo EEEEBBBBNNNNFFFF

       EBNF is a concise and exact way of describing the grammar
       of a language.  Each EBNF definition is made up of
       _p_r_o_d_u_c_t_i_o_n _r_u_l_e_s.  Eg.

        symbol ::= definition | alternate1 | alternate2 ...

       Each _p_r_o_d_u_c_t_i_o_n _r_u_l_e references others and thus makes up a
       grammar for the language.  EBNF also contains the
       following operators, which many readers will recognize
       from regular expressions.  Do not, however, confuse them
       with "wildcard" characters, which have different meanings.

       ?       Means that the preceding symbol (or group of
               symbols) is optional.  That is, it may appear once
               or not at all.

       *       Means that the preceding symbol (or group of
               symbols) may appear zero or more times.

       +       Means that the preceding symbol (or group of
               symbols) may appear one or more times.

       Parentheses may be used to group symbols together.  For
       clarity, we will use single quotes ('') to designate what
       is a verbatim character string (as opposed to a symbol
       name).

       AAAAlllliiiiaaaasssseeeessss

       There are four kinds of aliases: the User_Alias,
       Runas_Alias, Host_Alias and Cmnd_Alias.

        Alias ::= 'User_Alias' = User_Alias (':' User_Alias)* |
                  'Runas_Alias' = Runas_Alias (':' Runas_Alias)* |
                  'Host_Alias' = Host_Alias (':' Host_Alias)* |
                  'Cmnd_Alias' = Cmnd_Alias (':' Cmnd_Alias)*

        User_Alias ::= NAME '=' User_List

        Runas_Alias ::= NAME '=' Runas_User_List




26/Mar/2000                   1.6.3                             1





sudoers(4)                 FILE FORMATS                sudoers(4)


        Host_Alias ::= NAME '=' Host_List

        Cmnd_Alias ::= NAME '=' Cmnd_List

        NAME ::= [A-Z]([A-Z][0-9]_)*

       Each _a_l_i_a_s definition is of the form

        Alias_Type NAME = item1, item2, ...

       where _A_l_i_a_s___T_y_p_e is one of User_Alias, Runas_Alias,
       Host_Alias, or Cmnd_Alias.  A NAME is a string of upper
       case letters, numbers, and the underscore characters
       ('_').  A NAME mmmmuuuusssstttt start with an upper case letter.  It
       is possible to put several alias definitions of the same
       type on a single line, joined by a semicolon (':').  Eg.

        Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

       The definitions of what constitutes a valid _a_l_i_a_s member
       follow.

        User_List ::= User |
                      User ',' User_List

        User ::= '!'* username |
                 '!'* '#'uid |
                 '!'* '%'group |
                 '!'* '+'netgroup |
                 '!'* User_Alias

       A User_List is made up of one or more usernames, uids
       (prefixed with '#'), System groups (prefixed with '%'),
       netgroups (prefixed with '+') and other aliases.  Each
       list item may be prefixed with one or more '!' operators.
       An odd number of '!' operators negates the value of the
       item; an even number just cancel each other out.

        Runas_List ::= Runas_User |
                       Runas_User ',' Runas_List

        Runas_User ::= '!'* username |
                       '!'* '#'uid |
                       '!'* '%'group |
                       '!'* +netgroup |
                       '!'* Runas_Alias

       Likewise, a Runas_List has the same possible elements as a
       User_List, except that it can include a Runas_Alias,
       instead of a User_Alias.

        Host_List ::= Host |
                      Host ',' Host_List




26/Mar/2000                   1.6.3                             2





sudoers(4)                 FILE FORMATS                sudoers(4)


        Host ::= '!'* hostname |
                 '!'* ip_addr |
                 '!'* network(/netmask)? |
                 '!'* '+'netgroup |
                 '!'* Host_Alias

       A Host_List is made up of one or more hostnames, IP
       addresses, network numbers, netgroups (prefixed with '+')
       and other aliases.  Again, the value of an item may be
       negated with the '!' operator.  If you do not specify a
       netmask with a network number, the netmask of the host's
       ethernet _i_n_t_e_r_f_a_c_e(s) will be used when matching.  The
       netmask may be specified either in dotted quad notation
       (eg.  255.255.255.0) or CIDR notation (number of bits, eg.
       24).  A hostname may include shell-style wildcards (see
       `Wildcards' section below), but unless the hostname
       command on your machine returns the fully qualified
       hostname, you'll need to use the _f_q_d_n option for wildcards
       to be useful.

        Cmnd_List ::= Cmnd |
                      Cmnd ',' Cmnd_List

        commandname ::= filename |
                        filename args |
                        filename '""'

        Cmnd ::= '!'* commandname |
                 '!'* directory |
                 '!'* Cmnd_Alias

       A Cmnd_List is a list of one or more commandnames,
       directories, and other aliases.  A commandname is a fully
       qualified filename which may include shell-style wildcards
       (see `Wildcards' section below).  A simple filename allows
       the user to run the command with any arguments he/she
       wishes.  However, you may also command line arguments
       (including wildcards).  Alternately, you can specify "" to
       indicate that the command may only be run wwwwiiiitttthhhhoooouuuutttt command
       line arguments.  A directory is a fully qualified pathname
       ending in a '/'.  When you specify a directory in a
       Cmnd_List, the user will be able to run any file within
       that directory (but not in any subdirectories therein).

       If a Cmnd has associated command line arguments, then the
       arguments in the Cmnd must match exactly those given by
       the user on the command line (or match the wildcards if
       there are any).  Note that the following characters must
       be escaped with a '\' if they are used in command
       arguments: ',', ':', '=', '\'.







26/Mar/2000                   1.6.3                             3





sudoers(4)                 FILE FORMATS                sudoers(4)


       DDDDeeeeffffaaaauuuullllttttssss

       Certain configuration options may be changed from their
       default values at runtime via one or more Default_Entry
       lines.  These may affect all users on any host, all users
       on a specific host, or just a specific user.  When
       multiple entries match, they are applied in order.  Where
       there are conflicting values, the last value on a matching
       line takes effect.

        Default_Type ::= 'Defaults' ||
                         'Defaults' ':' User ||
                         'Defaults' '@' Host

        Default_Entry ::= Default_Type Parameter_List

        Parameter ::= Parameter '=' Value ||
                      '!'* Parameter ||

       Parameters may be ffffllllaaaaggggssss, iiiinnnntttteeeeggggeeeerrrr values, or ssssttttrrrriiiinnnnggggssss.
       Flags are implicitly boolean and can be turned off via the
       '!' operator.  Some integer and string parameters may also
       be used in a boolean context to disable them.  Values may
       be enclosed in double quotes (") when they contain
       multiple words.  Special characters may be escaped with a
       backslash (\).

       FFFFllllaaaaggggssss:

       long_otp_prompt
                   When validating with a One Time Password
                   scheme (SSSS////KKKKeeeeyyyy or OOOOPPPPIIIIEEEE), a two-line prompt is
                   used to make it easier to cut and paste the
                   challenge to a local window.  It's not as
                   pretty as the default but some people find it
                   more convenient.  This flag is off by default.

       ignore_dot  If set, ssssuuuuddddoooo will ignore '.' or '' (current
                   dir) in $PATH; the $PATH itself is not
                   modified.  This flag is off by default.

       mail_always Send mail to the _m_a_i_l_t_o user every time a
                   users runs ssssuuuuddddoooo.  This flag is off by default.

       mail_no_user
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user is not in the _s_u_d_o_e_r_s
                   file.  This flag is on by default.

       mail_no_host
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user exists in the _s_u_d_o_e_r_s
                   file, but is not allowed to run commands on
                   the current host.  This flag is off by



26/Mar/2000                   1.6.3                             4





sudoers(4)                 FILE FORMATS                sudoers(4)


                   default.

       mail_no_perms
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user allowed to use ssssuuuuddddoooo but
                   the command they are trying is not listed in
                   their _s_u_d_o_e_r_s file entry.  This flag is off by
                   default.

       tty_tickets If set, users must authenticate on a per-tty
                   basis.  Normally, ssssuuuuddddoooo uses a directory in the
                   ticket dir with the same name as the user
                   running it.  With this flag enabled, ssssuuuuddddoooo will
                   use a file named for the tty the user is
                   logged in on in that directory.  This flag is
                   off by default.

       lecture     If set, a user will receive a short lecture
                   the first time he/she runs ssssuuuuddddoooo.  This flag is
                   on by default.

       authenticate
                   If set, users must authenticate themselves via
                   a password (or other means of authentication)
                   before they may run commands.  This default
                   may be overridden via the PASSWD and NOPASSWD
                   tags.  This flag is on by default.

       root_sudo   If set, root is allowed to run ssssuuuuddddoooo too.
                   Disabling this prevents users from "chaining"
                   ssssuuuuddddoooo commands to get a root shell by doing
                   something like "sudo sudo /bin/sh".  This flag
                   is on by default.

       log_host    If set, the hostname will be logged in the
                   (non-syslog) ssssuuuuddddoooo log file.  This flag is off
                   by default.

       log_year    If set, the four-digit year will be logged in
                   the (non-syslog) ssssuuuuddddoooo log file.  This flag is
                   off by default.

       shell_noargs
                   If set and ssssuuuuddddoooo is invoked with no arguments
                   it acts as if the -s flag had been given.
                   That is, it runs a shell as root (the shell is
                   determined by the SHELL environment variable
                   if it is set, falling back on the shell listed
                   in the invoking user's /etc/passwd entry if
                   not).  This flag is off by default.

       set_home    If set and ssssuuuuddddoooo is invoked with the -s flag
                   the HOME environment variable will be set to
                   the home directory of the target user (which



26/Mar/2000                   1.6.3                             5





sudoers(4)                 FILE FORMATS                sudoers(4)


                   is root unless the -u option is used).  This
                   effectively makes the -s flag imply -H.  This
                   flag is off by default.

       path_info   Normally, ssssuuuuddddoooo will tell the user when a
                   command could not be found in their $PATH.
                   Some sites may wish to disable this as it
                   could be used to gather information on the
                   location of executables that the normal user
                   does not have access to.  The disadvantage is
                   that if the executable is simply not in the
                   user's $PATH, ssssuuuuddddoooo will tell the user that
                   they are not allowed to run it, which can be
                   confusing.  This flag is off by default.

       fqdn        Set this flag if you want to put fully
                   qualified hostnames in the _s_u_d_o_e_r_s file.  Ie:
                   instead of myhost you would use
                   myhost.mydomain.edu.  You may still use the
                   short form if you wish (and even mix the two).
                   Beware that turning on _f_q_d_n requires ssssuuuuddddoooo to
                   make DNS lookups which may make ssssuuuuddddoooo unusable
                   if DNS stops working (for example if the
                   machine is not plugged into the network).
                   Also note that you must use the host's
                   official name as DNS knows it.  That is, you
                   may not use a host alias (CNAME entry) due to
                   performance issues and the fact that there is
                   no way to get all aliases from DNS.  If your
                   machine's hostname (as returned by the
                   hostname command) is already fully qualified
                   you shouldn't need to set _f_q_f_n.  This flag is
                   off by default.

       insults     If set, ssssuuuuddddoooo will insult users when they enter
                   an incorrect password.  This flag is off by
                   default.

       requiretty  If set, ssssuuuuddddoooo will only run when the user is
                   logged in to a real tty.  This will disallow
                   things like "rsh somehost sudo ls" since
                   _r_s_h(1) does not allocate a tty.  Because it is
                   not possible to turn of echo when there is no
                   tty present, some sites may with to set this
                   flag to prevent a user from entering a visible
                   password.  This flag is off by default.

       env_editor  If set, vvvviiiissssuuuuddddoooo will use the value of the
                   EDITOR or VISUAL environment falling back on
                   the default editor.  Note that this may create
                   a security hole as most editors allow a user
                   to get a shell (which would be a root shell
                   and not be logged).




26/Mar/2000                   1.6.3                             6





sudoers(4)                 FILE FORMATS                sudoers(4)


       rootpw      If set, ssssuuuuddddoooo will prompt for the root password
                   instead of the password of the invoking user.

       runaspw     If set, ssssuuuuddddoooo will prompt for the password of
                   the user defined by the _r_u_n_a_s___d_e_f_a_u_l_t option
                   (defaults to root) instead of the password of
                   the invoking user.

       targetpw    If set, ssssuuuuddddoooo will prompt for the password of
                   the user specified by the -u flag (defaults to
                   root) instead of the password of the invoking
                   user.

       set_logname Normally, ssssuuuuddddoooo will set the LOGNAME and USER
                   environment variables to the name of the
                   target user (usually root unless the -u flag
                   is given).  However, since some programs
                   (including the RCS revision control system)
                   use LOGNAME to determine the real identity of
                   the user, it may be desirable to change this
                   behavior.  This can be done by negating the
                   set_logname option.

       use_loginclass
                   If set, ssssuuuuddddoooo will apply the defaults specified
                   for the target user's login class if one
                   exists.  Only available if ssssuuuuddddoooo is configured
                   with the --with-logincap option.

       IIIInnnntttteeeeggggeeeerrrrssss:

       passwd_tries
                   The number of tries a user gets to enter
                   his/her password before ssssuuuuddddoooo logs the failure
                   and exits.  The default is 3.

       IIIInnnntttteeeeggggeeeerrrrssss tttthhhhaaaatttt ccccaaaannnn bbbbeeee uuuusssseeeedddd iiiinnnn aaaa bbbboooooooolllleeeeaaaannnn ccccoooonnnntttteeeexxxxtttt:

       loglinelen  Number of characters per line for the file
                   log.  This value is used to decide when to
                   wrap lines for nicer log files.  This has no
                   effect on the syslog log file, only the file
                   log.  The default is 80 (use 0 or negate to
                   disable word wrap).

       timestamp_timeout
                   Number of minutes that can elapse before ssssuuuuddddoooo
                   will ask for a passwd again.  The default is
                   5, set this to 0 to always prompt for a
                   password.

       passwd_timeout
                   Number of minutes before the ssssuuuuddddoooo password
                   prompt times out.  The default is 5, set this



26/Mar/2000                   1.6.3                             7





sudoers(4)                 FILE FORMATS                sudoers(4)


                   to 0 for no password timeout.

       umask       Umask to use when running the root command.
                   Set this to 0777 to not override the user's
                   umask.  The default is 0022.

       SSSSttttrrrriiiinnnnggggssss:

       mailsub     Subject of the mail sent to the _m_a_i_l_t_o user.
                   The escape %h will expand to the hostname of
                   the machine.  Default is "*** SECURITY
                   information for %h ***".

       badpass_message
                   Message that is displayed if a user enters an
                   incorrect password.  The default is "Sorry,
                   try again." unless insults are enabled.

       timestampdir
                   The directory in which ssssuuuuddddoooo stores its
                   timestamp files.  The default is _@_T_I_M_E_D_I_R_@.

       passprompt  The default prompt to use when asking for a
                   password; can be overridden via the -p option
                   or the SUDO_PROMPT environment variable.
                   Supports two escapes: "%u" expands to the
                   user's login name and "%h" expands to the
                   local hostname.  The default value is
                   "Password:".

       runas_default
                   The default user to run commands as if the -u
                   flag is not specified on the command line.
                   This defaults to "root".

       syslog_goodpri
                   Syslog priority to use when user authenticates
                   successfully.  Defaults to "notice".

       syslog_badpri
                   Syslog priority to use when user authenticates
                   unsuccessfully.  Defaults to "alert".

       editor      Path to the editor to be used by vvvviiiissssuuuuddddoooo.  The
                   default is the path to vi on your system.

       SSSSttttrrrriiiinnnnggggssss tttthhhhaaaatttt ccccaaaannnn bbbbeeee uuuusssseeeedddd iiiinnnn aaaa bbbboooooooolllleeeeaaaannnn ccccoooonnnntttteeeexxxxtttt:

       logfile     Path to the ssssuuuuddddoooo log file (not the syslog log
                   file).  Setting a path turns on logging to a
                   file, negating this option turns it off.

       syslog      Syslog facility if syslog is being used for
                   logging (negate to disable syslog logging).



26/Mar/2000                   1.6.3                             8





sudoers(4)                 FILE FORMATS                sudoers(4)


                   Defaults to "local2".

       mailerpath  Path to mail program used to send warning
                   mail.  Defaults to the path to sendmail found
                   at configure time.

       mailerflags Flags to use when invoking mailer. Defaults to
                   -t.

       mailto      Address to send warning and erorr mail to.
                   Defaults to "root".

       exempt_group
                   Users in this group are exempt from password
                   and PATH requirements.  This is not set by
                   default.

       secure_path Path used for every command run from ssssuuuuddddoooo.  If
                   you don't trust the people running ssssuuuuddddoooo to
                   have a sane PATH environment variable you may
                   want to use this.  Another use is if you want
                   to have the "root path" be separate from the
                   "user path."  This is not set by default.

       verifypw    This option controls when a password will be
                   required when a user runs ssssuuuuddddoooo with the ----vvvv.
                   It has the following possible values:

                       all         All the user's I<sudoers> entries for the
                                   current host must have the C<NOPASSWD>
                                   flag set to avoid entering a password.

                       any         At least one of the user's I<sudoers> entries
                                   for the current host must have the
                                   C<NOPASSWD> flag set to avoid entering a
                                   password.

                       never       The user need never enter a password to use
                                   the B<-v> flag.

                       always      The user must always enter a password to use
                                   the B<-v> flag.

                   The default value is `all'.

       listpw      This option controls when a password will be
                   required when a user runs ssssuuuuddddoooo with the ----llll.
                   It has the following possible values:

                       all         All the user's I<sudoers> entries for the
                                   current host must have the C<NOPASSWD>
                                   flag set to avoid entering a password.





26/Mar/2000                   1.6.3                             9





sudoers(4)                 FILE FORMATS                sudoers(4)


                       any         At least one of the user's I<sudoers> entries
                                   for the current host must have the
                                   C<NOPASSWD> flag set to avoid entering a
                                   password.

                       never       The user need never enter a password to use
                                   the B<-l> flag.

                       always      The user must always enter a password to use
                                   the B<-l> flag.

                   The default value is `any'.

       When logging via _s_y_s_l_o_g(3), ssssuuuuddddoooo accepts the following
       values for the syslog facility (the value of the ssssyyyysssslllloooogggg
       Parameter): aaaauuuutttthhhhpppprrrriiiivvvv (if your OS supports it), aaaauuuutttthhhh,
       ddddaaaaeeeemmmmoooonnnn, uuuusssseeeerrrr, llllooooccccaaaallll0000, llllooooccccaaaallll1111, llllooooccccaaaallll2222, llllooooccccaaaallll3333, llllooooccccaaaallll4444,
       llllooooccccaaaallll5555, llllooooccccaaaallll6666, and llllooooccccaaaallll7777.  The following syslog
       priorities are supported: aaaalllleeeerrrrtttt, ccccrrrriiiitttt, ddddeeeebbbbuuuugggg, eeeemmmmeeeerrrrgggg, eeeerrrrrrrr,
       iiiinnnnffffoooo, nnnnoooottttiiiicccceeee, and wwwwaaaarrrrnnnniiiinnnngggg.

       UUUUsssseeeerrrr SSSSppppeeeecccciiiiffffiiiiccccaaaattttiiiioooonnnn


        User_Spec ::= User_list Host_List '=' User_List Cmnd_Spec_List \
                      (':' User_Spec)*

        Cmnd_Spec_List ::= Cmnd_Spec |
                           Cmnd_Spec ',' Cmnd_Spec_List

        Cmnd_Spec ::= Runas_Spec? ('NOPASSWD:' | 'PASSWD:')? Cmnd

        Runas_Spec ::= '(' Runas_List ')'

       A uuuusssseeeerrrr ssssppppeeeecccciiiiffffiiiiccccaaaattttiiiioooonnnn determines which commands a user may
       run (and as what user) on specified hosts.  By default,
       commands are run as rrrrooooooootttt but this can be changed on a per-
       command basis.

       Let's break that down into its constituent parts:

       RRRRuuuunnnnaaaassss____SSSSppppeeeecccc

       A Runas_Spec is simply a Runas_List (as defined above)
       enclosed in a set of parentheses.  If you do not specify a
       Runas_Spec in the user specification, a default Runas_Spec
       of rrrrooooooootttt will be used.  A Runas_Spec sets the default for
       commands that follow it.  What this means is that for the
       entry:

        dgb    boulder = (operator) /bin/ls, /bin/kill, /usr/bin/who

       The user ddddggggbbbb may run _/_b_i_n_/_l_s, _/_b_i_n_/_k_i_l_l, and _/_u_s_r_/_b_i_n_/_l_p_r_m
       -- but only as ooooppppeeeerrrraaaattttoooorrrr.  Eg.



26/Mar/2000                   1.6.3                            10





sudoers(4)                 FILE FORMATS                sudoers(4)


           sudo -u operator /bin/ls.

       It is also possible to override a Runas_Spec later on in
       an entry.  If we modify the entry like so:

        dgb    boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm

       Then user ddddggggbbbb is now allowed to run _/_b_i_n_/_l_s as ooooppppeeeerrrraaaattttoooorrrr,
       but  _/_b_i_n_/_k_i_l_l and _/_u_s_r_/_b_i_n_/_l_p_r_m as rrrrooooooootttt.

       NNNNOOOOPPPPAAAASSSSSSSSWWWWDDDD aaaannnndddd PPPPAAAASSSSSSSSWWWWDDDD

       By default, ssssuuuuddddoooo requires that a user authenticate him or
       herself before running a command.  This behavior can be
       modified via the NOPASSWD tag.  Like a Runas_Spec, the
       NOPASSWD tag sets a default for the commands that follow
       it in the Cmnd_Spec_List.  Conversely, the PASSWD tag can
       be used to reverse things.  For example:

        ray    rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm

       would allow the user rrrraaaayyyy to run _/_b_i_n_/_k_i_l_l, _/_b_i_n_/_l_s, and
       _/_u_s_r_/_b_i_n_/_l_p_r_m as root on the machine rushmore as rrrrooooooootttt
       without authenticating himself.  If we only want rrrraaaayyyy to be
       able to run _/_b_i_n_/_k_i_l_l without a password the entry would
       be:

        ray    rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm

       Note however, that the PASSWD tag has no effect on users
       who are in the group specified by the exempt_group option.

       By default, if the NOPASSWD tag is applied to any of the
       entries for a user on the current host, he or she will be
       able to run sudo -l without a password.  Additionally, a
       user may only run sudo -v without a password if the
       NOPASSWD tag is present for all a user's entries that
       pertain to the current host.  This behavior may be
       overridden via the verifypw and listpw options.

       WWWWiiiillllddddccccaaaarrrrddddssss ((((aaaakkkkaaaa mmmmeeeettttaaaa cccchhhhaaaarrrraaaacccctttteeeerrrrssss))))::::

       ssssuuuuddddoooo allows shell-style _w_i_l_d_c_a_r_d_s to be used in pathnames
       as well as command line arguments in the _s_u_d_o_e_r_s file.
       Wildcard matching is done via the PPPPOOOOSSSSIIIIXXXX fnmatch(3)
       routine.  Note that these are _n_o_t regular expressions.

       *       Matches any set of zero or more characters.

       ?       Matches any single character.

       [...]   Matches any character in the specified range.





26/Mar/2000                   1.6.3                            11





sudoers(4)                 FILE FORMATS                sudoers(4)


       [!...]  Matches any character nnnnooootttt in the specified range.

       \x      For any character "x", evaluates to "x".  This is
               used to escape special characters such as: "*",
               "?", "[", and "}".

       Note that a forward slash ('/') will nnnnooootttt be matched by
       wildcards used in the pathname.  When matching the command
       line arguments, however, as slash ddddooooeeeessss get matched by
       wildcards.  This is to make a path like:

           /usr/bin/*

       match /usr/bin/who but not /usr/bin/X11/xterm.

       EEEExxxxcccceeeeppppttttiiiioooonnnnssss ttttoooo wwwwiiiillllddddccccaaaarrrrdddd rrrruuuulllleeeessss::::

       The following exceptions apply to the above rules:

       ""      If the empty string "" is the only command line
               argument in the _s_u_d_o_e_r_s entry it means that
               command is not allowed to be run with aaaannnnyyyy
               arguments.

       OOOOtttthhhheeeerrrr ssssppppeeeecccciiiiaaaallll cccchhhhaaaarrrraaaacccctttteeeerrrrssss aaaannnndddd rrrreeeesssseeeerrrrvvvveeeedddd wwwwoooorrrrddddssss::::

       The pound sign ('#') is used to indicate a comment (unless
       it occurs in the context of a user name and is followed by
       one or more digits, in which case it is treated as a uid).
       Both the comment character and any text after it, up to
       the end of the line, are ignored.

       The reserved word AAAALLLLLLLL is a built in _a_l_i_a_s that always
       causes a match to succeed.  It can be used wherever one
       might otherwise use a Cmnd_Alias, User_Alias, Runas_Alias,
       or Host_Alias.  You should not try to define your own
       _a_l_i_a_s called AAAALLLLLLLL as the built in alias will be used in
       preference to your own.  Please note that using AAAALLLLLLLL can be
       dangerous since in a command context, it allows the user
       to run aaaannnnyyyy command on the system.

       An exclamation point ('!') can be used as a logical _n_o_t
       operator both in an _a_l_i_a_s and in front of a Cmnd.  This
       allows one to exclude certain values.  Note, however, that
       using a ! in conjunction with the built in ALL alias to
       allow a user to run "all but a few" commands rarely works
       as intended (see SECURITY NOTES below).

       Long lines can be continued with a backslash ('\') as the
       last character on the line.

       Whitespace between elements in a list as well as specicial
       syntactic characters in a _U_s_e_r _S_p_e_c_i_f_i_c_a_t_i_o_n ('=', ':',
       '(', ')') is optional.



26/Mar/2000                   1.6.3                            12





sudoers(4)                 FILE FORMATS                sudoers(4)


       The following characters must be escaped with a backslash
       ('\') when used as part of a word (eg. a username or
       hostname): '@', '!', '=', ':', ',', '(', ')', '\'.

EEEEXXXXAAAAMMMMPPPPLLLLEEEESSSS
       Below are example _s_u_d_o_e_r_s entries.  Admittedly, some of
       these are a bit contrived.  First, we define our _a_l_i_a_s_e_s:

        # User alias specification
        User_Alias     FULLTIMERS = millert, mikef, dowdy
        User_Alias     PARTTIMERS = bostley, jwfox, crawl
        User_Alias     WEBMASTERS = will, wendy, wim

        # Runas alias specification
        Runas_Alias    OP = root, operator
        Runas_Alias    DB = oracle, sybase

        # Host alias specification
        Host_Alias     SPARC = bigtime, eclipse, moet, anchor :\
                       SGI = grolsch, dandelion, black :\
                       ALPHA = widget, thalamus, foobar :\
                       HPPA = boa, nag, python
        Host_Alias     CUNETS = 128.138.0.0/255.255.0.0
        Host_Alias     CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
        Host_Alias     SERVERS = master, mail, www, ns
        Host_Alias     CDROM = orion, perseus, hercules

        # Cmnd alias specification
        Cmnd_Alias     DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
                               /usr/sbin/restore, /usr/sbin/rrestore
        Cmnd_Alias     KILL = /usr/bin/kill
        Cmnd_Alias     PRINTING = /usr/sbin/lpc, /usr/bin/lprm
        Cmnd_Alias     SHUTDOWN = /usr/sbin/shutdown
        Cmnd_Alias     HALT = /usr/sbin/halt, /usr/sbin/fasthalt
        Cmnd_Alias     REBOOT = /usr/sbin/reboot, /usr/sbin/fastboot
        Cmnd_Alias     SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh, \
                                /usr/local/bin/tcsh, /usr/bin/rsh, \
                                /usr/local/bin/zsh
        Cmnd_Alias     SU = /usr/bin/su

       Here we override some of the compiled in default values.
       We want ssssuuuuddddoooo to log via _s_y_s_l_o_g(3) using the _a_u_t_h facility
       in all cases.  We don't want to subject the full time
       staff to the ssssuuuuddddoooo lecture, and user mmmmiiiilllllllleeeerrrrtttt need not give
       a password.  In addition, on the machines in the _S_E_R_V_E_R_S
       Host_Alias, we keep an additional local log file and make
       sure we log the year in each log line since the log
       entries will be kept around for several years.

        # Override builtin defaults
        Defaults               syslog=auth
        Defaults:FULLTIMERS    !lecture
        Defaults:millert       !authenticate
        Defaults@SERVERS       log_year, logfile=/var/log/sudo.log



26/Mar/2000                   1.6.3                            13





sudoers(4)                 FILE FORMATS                sudoers(4)


       The _U_s_e_r _s_p_e_c_i_f_i_c_a_t_i_o_n is the part that actually
       determines who may run what.

        root           ALL = (ALL) ALL
        %wheel         ALL = (ALL) ALL

       We let rrrrooooooootttt and any user in group wwwwhhhheeeeeeeellll run any command on
       any host as any user.

        FULLTIMERS     ALL = NOPASSWD: ALL

       Full time sysadmins (mmmmiiiilllllllleeeerrrrtttt, mmmmiiiikkkkeeeeffff, and ddddoooowwwwddddyyyy) may run
       any command on any host without authenticating themselves.

        PARTTIMERS     ALL = ALL

       Part time sysadmins (bbbboooossssttttlllleeeeyyyy, jjjjwwwwffffooooxxxx, and ccccrrrraaaawwwwllll) may run
       any command on any host but they must authenticate
       themselves first (since the entry lacks the NOPASSWD tag).

        jack           CSNETS = ALL

       The user jjjjaaaacccckkkk may run any command on the machines in the
       _C_S_N_E_T_S alias (the networks 128.138.243.0, 128.138.204.0,
       and 128.138.242.0).  Of those networks, only
       <128.138.204.0> has an explicit netmask (in CIDR notation)
       indicating it is a class C network.  For the other
       networks in _C_S_N_E_T_S, the local machine's netmask will be
       used during matching.

        lisa           CUNETS = ALL

       The user lllliiiissssaaaa may run any command on any host in the
       _C_U_N_E_T_S alias (the class B network 128.138.0.0).

        operator       ALL = DUMPS, KILL, PRINTING, SHUTDOWN, HALT, REBOOT,\
                       /usr/oper/bin/

       The ooooppppeeeerrrraaaattttoooorrrr user may run commands limited to simple
       maintenance.  Here, those are commands related to backups,
       killing processes, the printing system, shutting down the
       system, and any commands in the directory _/_u_s_r_/_o_p_e_r_/_b_i_n_/.

        joe            ALL = /usr/bin/su operator

       The user jjjjooooeeee may only _s_u(1) to operator.

        pete           HPPA = /usr/bin/passwd [A-z]*, !/usr/bin/passwd root

       The user ppppeeeetttteeee is allowed to change anyone's password
       except for root on the _H_P_P_A machines.  Note that this
       assumes _p_a_s_s_w_d(1) does not take multiple usernames on the
       command line.




26/Mar/2000                   1.6.3                            14





sudoers(4)                 FILE FORMATS                sudoers(4)


        bob            SPARC = (OP) ALL : SGI = (OP) ALL

       The user bbbboooobbbb may run anything on the _S_P_A_R_C and _S_G_I
       machines as any user listed in the _O_P Runas_Alias (rrrrooooooootttt
       and ooooppppeeeerrrraaaattttoooorrrr).

        jim            +biglab = ALL

       The user jjjjiiiimmmm may run any command on machines in the _b_i_g_l_a_b
       netgroup.  SSSSuuuuddddoooo knows that "biglab" is a netgroup due to
       the '+' prefix.

        +secretaries   ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

       Users in the sssseeeeccccrrrreeeettttaaaarrrriiiieeeessss netgroup need to help manage the
       printers as well as add and remove users, so they are
       allowed to run those commands on all machines.

        fred           ALL = (DB) NOPASSWD: ALL

       The user ffffrrrreeeedddd can run commands as any user in the _D_B
       Runas_Alias (oooorrrraaaacccclllleeee or ssssyyyybbbbaaaasssseeee) without giving a password.

        john           ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*

       On the _A_L_P_H_A machines, user jjjjoooohhhhnnnn may su to anyone except
       root but he is not allowed to give _s_u(1) any flags.

        jen            ALL, !SERVERS = ALL

       The user jjjjeeeennnn may run any command on any machine except for
       those in the _S_E_R_V_E_R_S Host_Alias (master, mail, www and
       ns).

        jill           SERVERS = /usr/bin/, !SU, !SHELLS

       For any machine in the _S_E_R_V_E_R_S Host_Alias, jjjjiiiillllllll may run
       any commands in the directory /usr/bin/ except for those
       commands belonging to the _S_U and _S_H_E_L_L_S Cmnd_Aliases.

        steve          CSNETS = (operator) /usr/local/op_commands/

       The user sssstttteeeevvvveeee may run any command in the directory
       /usr/local/op_commands/ but only as user operator.

        matt           valkyrie = KILL

       On his personal workstation, valkyrie, mmmmaaaatttttttt needs to be
       able to kill hung processes.

        WEBMASTERS     www = (www) ALL, (root) /usr/bin/su www

       On the host www, any user in the _W_E_B_M_A_S_T_E_R_S User_Alias
       (will, wendy, and wim), may run any command as user www



26/Mar/2000                   1.6.3                            15





sudoers(4)                 FILE FORMATS                sudoers(4)


       (which owns the web pages) or simply _s_u(1) to www.

        ALL            CDROM = NOPASSWD: /sbin/umount /CDROM,\
                       /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

       Any user may mount or unmount a CD-ROM on the machines in
       the CDROM Host_Alias (orion, perseus, hercules) without
       entering a password.  This is a bit tedious for users to
       type, so it is a prime candiate for encapsulating in a
       shell script.

SSSSEEEECCCCUUUURRRRIIIITTTTYYYY NNNNOOOOTTTTEEEESSSS
       It is generally not effective to "subtract" commands from
       ALL using the '!' operator.  A user can trivially
       circumvent this by copying the desired command to a
       different name and then executing that.  For example:

           bill        ALL = ALL, !SU, !SHELLS

       Doesn't really prevent bbbbiiiillllllll from running the commands
       listed in _S_U or _S_H_E_L_L_S since he can simply copy those
       commands to a different name, or use a shell escape from
       an editor or other program.  Therefore, these kind of
       restrictions should be considered advisory at best (and
       reinforced by policy).

CCCCAAAAVVVVEEEEAAAATTTTSSSS
       The _s_u_d_o_e_r_s file should aaaallllwwwwaaaayyyyssss be edited by the vvvviiiissssuuuuddddoooo
       command which locks the file and does grammatical
       checking. It is imperative that _s_u_d_o_e_r_s be free of syntax
       errors since ssssuuuuddddoooo will not run with a syntactically
       incorrect _s_u_d_o_e_r_s file.

       When using netgroups of machines (as opposed to users), if
       you store fully qualified hostnames in the netgroup (as is
       usually the case), you either need to have the machine's
       hostname be fully qualified as returned by the hostname
       command or use the _f_q_d_n option in _s_u_d_o_e_r_s.

FFFFIIIILLLLEEEESSSS
        /etc/sudoers           List of who can run what
        /etc/group             Local groups file
        /etc/netgroup          List of network groups


SSSSEEEEEEEE AAAALLLLSSSSOOOO
       _s_u_d_o(1m), _v_i_s_u_d_o(1m), _s_u(1), _f_n_m_a_t_c_h(3).










26/Mar/2000                   1.6.3                            16





sudoers(4)                 FILE FORMATS                sudoers(4)



























































26/Mar/2000                   1.6.3                            17


